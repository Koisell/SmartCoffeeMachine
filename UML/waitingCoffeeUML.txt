@startuml

== Repetition ==
waitingCoffees -> MachineStatus: isReady()
alt machine is ready to make a coffee
    MachineStatus --> waitingCoffees: "OK"
    waitingCoffees -> MachineController: getCoffee(*param)

else there is no water in tank
    MachineStatus --> waitingCoffees: "OUT OF WATER"
    waitingCoffees -> waitingCoffees: notifyAll(OOW)
    ... after refull ...
    MachineStatus -> waitingCoffees: "OK"
    waitingCoffees -> waitingCoffees: notifyAll(READY)
    waitingCoffees -> MachineController: getCoffee(*param)

else there is no coffee left
    MachineStatus --> waitingCoffees: "OUT OF COFFEE"
    waitingCoffees -> waitingCoffees: notifyAll(OOC)
    ... after refull ...
    MachineStatus -> waitingCoffees: "OK"
    waitingCoffees -> waitingCoffees: notifyAll(READY)
    waitingCoffees -> MachineController: getCoffee(*param)

end

@enduml